#include "bsp_gpio.h"
#include "platform.h"

void tim2_Config(void)
{
    TIM_TimeBaseInitTypeDef TIM_TimeBaseStructure;
    /*???atmr2??????? */
    RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM2, ENABLE); // 72M
    /* Time base configuration */
    TIM_TimeBaseStructure.TIM_Period =
        0XFFFE; //???????????????????????  ARR   65536  N-1
    TIM_TimeBaseStructure.TIM_Prescaler =
        1151; //?????????ñÂ????  PSC  N-1    16us one time
    TIM_TimeBaseStructure.TIM_ClockDivision =
        0; // CR1  ??a2?????y2???????2????????????????????????2??e??????
    TIM_TimeBaseStructure.TIM_CounterMode = TIM_CounterMode_Up; //??????????y
    TIM_TimeBaseStructure.TIM_RepetitionCounter = 0;
    TIM_TimeBaseInit(TIM2, &TIM_TimeBaseStructure);
    /* TIM IT enable */
    TIM_ITConfig(TIM2, TIM_IT_Update, ENABLE);
    /* TIM2 enable counter */
    TIM_Cmd(TIM2, ENABLE);
}
void tim3_Config(void)
{
    TIM_TimeBaseInitTypeDef TIM_TimeBaseStructure;
    /*???atmr3??????? */
    RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM3, ENABLE); // 72M
    /* Time base configuration */
    TIM_TimeBaseStructure.TIM_Period = 250; //???????????????????????  ARR    N-1
    TIM_TimeBaseStructure.TIM_Prescaler =
        575; //?????????ñÂ????  PSC  N-1    8us one time
    TIM_TimeBaseStructure.TIM_ClockDivision =
        0; // CR1  ??a2?????y2???????2????????????????????????2??e??????
    TIM_TimeBaseStructure.TIM_CounterMode = TIM_CounterMode_Up; //??????????y
    TIM_TimeBaseStructure.TIM_RepetitionCounter = 0;
    TIM_TimeBaseInit(TIM3, &TIM_TimeBaseStructure);
    /* TIM IT enable */
    TIM_ITConfig(TIM3, TIM_IT_Update, ENABLE);
    /* TIM2 enable counter */
    TIM_Cmd(TIM3, ENABLE);
}
